# P3-A-04: Add get_events MCP Tool Handler

## Date
2026-02-13

## Goals
- Implement `get_events` MCP tool for fetching calendar events from Intervals.icu
- Follow existing patterns from `get-wellness.ts` and `get-activities.ts`
- Register tool in the gateway

## Key Decisions
- Followed `get-wellness.ts` pattern for date validation (round-trip check, auto-swap, 90-day cap)
- Default date range: today to 14 days from now (forward-looking for events vs. backward-looking for wellness)
- Added runtime validation of event type filters against a `Set` of allowed values (addressing Copilot review pattern #2)
- Used `!= null` for nullish checks (Copilot review pattern #6)
- Provided 7 diverse mock events covering all event types (workout, rest_day, race, travel, note)

## Files Changed
- `supabase/functions/mcp-gateway/tools/get-events.ts` (Created) - Tool implementation with CalendarEvent interface, definition, input parsing, mock data, filtering, and handler
- `supabase/functions/mcp-gateway/tools/index.ts` (Modified) - Added import and registration, removed placeholder comment

## Learnings
- Biome enforces line length on description strings - need to break them across lines
- Pre-existing lint warnings in mobile test files don't block new file linting

## PR
https://github.com/bilaltawfic/khepri/pull/64
